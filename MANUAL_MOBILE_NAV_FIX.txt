# Manual Mobile Navigation Fix for Server
# Run these commands on your server via SSH

cd ~/tool-thinker

# Step 1: Backup the file
cp components/Navigation.tsx components/Navigation.tsx.backup

# Step 2: Update the import statement
sed -i 's/import { useState } from "react"/import { useState, useEffect } from "react"/' components/Navigation.tsx

# Step 3: Add useEffect after pathname declaration
# Find this line: const pathname = usePathname()
# Add after it:
sed -i '/const pathname = usePathname()/a\
  \
  // Close menu when route changes\
  useEffect(() => {\
    setIsMenuOpen(false)\
  }, [pathname])' components/Navigation.tsx

# Step 4: Add onClick to close menu for Home link
sed -i 's|href="/" \n              className={`block px-4 py-2 hover:bg-gray-100|& onClick={() => setIsMenuOpen(false)}|' components/Navigation.tsx

# Step 5: Add onClick to Tools main link
sed -i 's|href="/tools"\n                className={`block font-semibold|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx

# Step 6: Add onClick to all Tools submenu links (run each separately)
sed -i 's|href="/tools" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx
sed -i 's|href="/tools/frameworks" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx
sed -i 's|href="/tools/framework-navigator" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx
sed -i 's|href="/tools/business-model-generator" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx
sed -i 's|href="/tools/start-smart-os" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx
sed -i 's|href="/tools/templates" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx
sed -i 's|href="/consultation" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx

# Step 7: Add onClick to Blogs and About
sed -i 's|href="/blogs" \n              className={`block px-4 py-2|& onClick={() => setIsMenuOpen(false)}|' components/Navigation.tsx
sed -i 's|href="/about" \n              className={`block px-4 py-2|& onClick={() => setIsMenuOpen(false)}|' components/Navigation.tsx

# Step 8: Add onClick to More submenu links
sed -i 's|href="/podcasts" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx
sed -i 's|href="/books" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx
sed -i 's|href="/contact" className={`block py-2|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx

# Step 9: Add onClick to Alpha Hustler link
sed -i 's|href="https://alphahustler.tech/" target="_blank"|& onClick={() => setIsMenuOpen(false)} |' components/Navigation.tsx

# Step 10: Update button with aria attributes
sed -i 's|<button\n            className="md:hidden text-gray-700"|& type="button" aria-label="Toggle menu" aria-expanded={isMenuOpen}|' components/Navigation.tsx

# Step 11: Add border-top to mobile menu
sed -i 's|className="md:hidden py-4 space-y-2"|& border-t border-gray-200 bg-white|' components/Navigation.tsx

# Step 12: Rebuild and restart
npm run build
pm2 restart tool-thinker

# Verify the changes
echo "Checking if useEffect was added:"
grep -A 3 "useEffect" components/Navigation.tsx | head -5

echo "Checking if onClick handlers were added:"
grep -c "onClick={() => setIsMenuOpen(false)}" components/Navigation.tsx

